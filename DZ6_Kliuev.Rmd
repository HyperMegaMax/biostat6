---
title: "ДЗ №6"
author: "Клюев Максим"
---
Пусть наш спонсор заинтересован, чтобы исследование имело 80% мощность, а уровень значимости — 5%, ожидаемый drop-out rate = 10%.

```{r}
# Параметры исследования
alpha <- 0.05
beta <- 0.2
dropout_rate <- 0.1
```

1. Рассчитайте выборку для исследования терапевтической эквивалентности для двухпериодного cross-over дизайна. Из предыдущих исследований известно, что дисперсия составляет 20% ( = 0.20), а разница средних составляет −10%. Клиницисты сообщают нам, что клинически значимая разница составляет 25% ( = 0.25).

```{r}
# Стандартное отклонение и разницы
sd <- sqrt(0.20)
delta <- 0.25

# Расчет размера выборки для двух групп, учитывая dropout rate
sample_size <- ceiling(((qnorm(1 - alpha / 2) + qnorm(beta))^2 * 2 * sd^2 / delta^2) / (1 - dropout_rate) * 2)

# Вывод результата
cat('Общий размер выборки n:', sample_size, '\n')

```

2. Рассчитайте выборку для гипотезы non-inferiority для двухвыборочного параллельного дизайна. Пусть клинически значимая разница  = -0.1, то есть мы ожидаем разницу не меньше 10%, а долю ответов для тестового препарата  = 0.65, в то время как нам известно из предыдущих исследований, что доля ответов у препарата сравнения составляет  = 0.85. Соотношение групп равно  = 1.

```{r}
# Установка параметров
p1 <- 0.85
p2 <- 0.65
delta <- -0.1

# Квантили нормального распределения
z_alpha_2 <- abs(qnorm(1 - alpha/2))
z_beta <- abs(qnorm(beta))

# Рассчитываем и округляем размер выборки для двух групп с учетом dropout rate
total_sample_size <- 2 * ceiling(((z_alpha_2 + z_beta)^2 * (p1 * (1 - p1) + p2 * (1 - p2)) / (p1 - p2 - delta)^2) / (1 - dropout_rate))

# Вывод результатов
cat('Общий размер выборки n:', total_sample_size, '\n')

```

3. Рассчитайте выборку для гипотезы equality для следующего исследования. Мы хотим сравнить новую терапию инфекции, присоединяющейся в больничных условиях у пациентов с ожогами, с золотым стандартом, основываясь на данных, анализируемых с помощью регрессии Кокса. Пусть отношение рисков «золотой стандарт / новая терапия», hazard ratio, HR = 2. Мы предполагаем, что 80% пациентов ( = 0.8) могут столкнуться с этим заболеванием. Соотношения групп терапии равны 0.5.

```{r}
# Параметры исследования
HR <- 2
d <- 0.8
p1 <- 0.5
p2 <- 0.5

# Квантили нормального распределения
z_alpha_2 <- abs(qnorm(1 - alpha/2))
z_beta <- abs(qnorm(beta))

# Расчёт и округление общего размера выборки для двух групп с учётом dropout rate
total_sample_size <- 2 * ceiling(((z_alpha_2 + z_beta)^2 / ((log(HR))^2 * p1 * p2 * d)) / (1 - dropout_rate))

# Вывод результатов
cat('Общий размер выборки n:', total_sample_size, '\n')

```
